(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a31954a"],{"09fe":function(t,e,s){},"0a53":function(t,e,s){"use strict";s("09fe")},c638:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"live-wrapper"},[s("div",{staticClass:"remark",class:{fixed:t.isFixedVideo},attrs:{id:"flag"}},[s("p",[t._v("若需更換裝置觀看，請點擊右方“離開觀看”，可於另一裝置以相同票券序號登入觀看。")]),s("div",{staticClass:"btn",on:{click:t.logoutApi}},[t._v("離開觀看")])]),s("div",{staticClass:"fixed-box",class:{fixed:t.isFixedVideo}},[t._m(0),s("div",{staticClass:"title"},[t._v("聊天室")])]),s("div",{staticClass:"chatroom"},[s("div",{staticClass:"chat-box",attrs:{id:"chatBox"},on:{scroll:t.scrollChatBox}},t._l(t.chatList,(function(e){return s("div",{staticClass:"chat-item"},[s("figure",{staticClass:"user-pic"},[s("img",{attrs:{src:e.url}})]),s("div",{staticClass:"user-info"},[s("div",{staticClass:"name"},[t._v(t._s(e.name))]),s("div",{staticClass:"chat"},[t._v(t._s(e.message))])])])})),0),s("div",{staticClass:"insert-box"},[s("figure",{staticClass:"user-pic"},[s("img",{attrs:{src:this.lineData.profilePicUrl}})]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.userMsg,expression:"userMsg",modifiers:{trim:!0}}],staticClass:"insert-txt",attrs:{type:"text",placeholder:"新增留言"},domProps:{value:t.userMsg},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMsg.apply(null,arguments)},input:function(e){e.target.composing||(t.userMsg=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"send-btn",on:{click:t.sendMsg}},[t._v("送出")])]),t.isDisconnected?s("div",{staticClass:"disconnected"},[s("p",[t._v("聊天室斷線，請重新整理")])]):t._e(),s("div",{staticClass:"arrow-down",class:{show:t.isScrollUp},on:{click:t.showNewChat}},[s("svg",{staticClass:"style-scope yt-icon",staticStyle:{"pointer-events":"none",display:"block",width:"100%",height:"100%"},attrs:{viewBox:"0 0 24 24",preserveAspectRatio:"xMidYMid meet",focusable:"false"}},[s("g",{staticClass:"style-scope yt-icon"},[s("path",{staticClass:"style-scope yt-icon",attrs:{d:"M16.9,14.9l-5.4,5.4l-5.4-5.4l0.7-0.7l4.1,4.1V4h1v14.3l4.1-4.1L16.9,14.9z"}})])])])]),t._m(1),t.showPopup?s("div",{staticClass:"popup"},[s("div",{staticClass:"container"},[s("p",[t._v("您已有登入觀看直播的裝置，請先在原裝置離開觀看，或點擊此按鈕")]),s("div",{staticClass:"main-btn popup-btn",on:{click:t.logoutAllApi}},[t._v("登出其他裝置直接觀看")])])]):t._e()])},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"live-box"},[s("div",{staticStyle:{padding:"56.25% 0 0 0",position:"relative"}},[s("iframe",{staticStyle:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},attrs:{src:"https://player.vimeo.com/video/652846845?h=c30e89e084&badge=0&autopause=0&player_id=0&app_id=58479",frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:"",title:"SUNRIDER 直播"}})])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"btn-box"},[i("img",{attrs:{src:s("a3ae")}}),i("a",{staticClass:"kv-btn",attrs:{href:"https://shop.sunrider.com/home.asp",target:"_blank"}},[t._v("立即搶購")])])}],n=s("5530"),c=(s("b0c0"),s("2f62")),a={name:"Live",components:{},props:{},mixins:[],data:function(){return{userMsg:"",chatList:[],isDisconnected:!1,isAllowSend:!0,chatBoxHeight:0,chatBoxPst:0,showPopup:!1,isFixedVideo:!1}},computed:Object(n["a"])(Object(n["a"])({},Object(c["d"])(["isLoading","lineData"])),{},{isScrollUp:function(){return this.chatBoxPst<this.chatBoxHeight}}),created:function(){window.addEventListener("scroll",this.handleScroll)},mounted:function(){var t=this;this.$nextTick((function(){t.init()}))},sockets:{connecting:function(){console.log("正在連接")},connect:function(){console.log("聊天室連線")},disconnect:function(){console.log("聊天室斷線"),alert("聊天室斷線，請重新整理"),this.isDisconnected=!0},ChatMessage:function(t){if(this.chatList.push(t),this.chatList.length>200&&this.chatList.shift(),this.chatBoxHeight=document.getElementById("chatBox").scrollHeight-document.getElementById("chatBox").offsetHeight,!this.isScrollUp||t.lineId==this.lineData.lineId){var e=document.getElementById("chatBox");setTimeout((function(){e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}),1)}},logout:function(t){console.log(t),t.lineId==this.lineData.lineId&&t.token!==this.token&&(alert("您目前已從其他裝置登入，將為您從此裝置登出。"),this.$router.push({name:"Home"}))}},methods:Object(n["a"])(Object(n["a"])({},Object(c["b"])(["setWatchStatus","liveLogout","liveLogoutAll","checkLiveStatus"])),{},{handleScroll:function(){this.isFixedVideo=window.scrollY>document.getElementById("flag").offsetTop+document.getElementById("flag").offsetHeight},init:function(){var t=this;this.lineLogin("1615800146-z47KQRGX").then((function(){t.checkLiveStatusApi()})).catch((function(){console.log("失敗")}))},checkWatchStatus:function(){var t=this;this.setWatchStatus().then((function(e){console.log(e),e.success?t.$socket.connect():t.showPopup=!0})).catch((function(){console.log("失敗")}))},checkLiveStatusApi:function(){var t=this;this.checkLiveStatus().then((function(e){console.log("success"),e.isBinding?t.checkWatchStatus():t.$router.push({name:"Exchange"})})).catch((function(e){console.log(e),"userVerificationError"==e&&t.init(),console.log("fail")}))},logoutAllApi:function(){var t=this;this.liveLogoutAll().then((function(e){console.log(e),t.showPopup=!1,t.$socket.connect()})).catch((function(){console.log("失敗")}))},logoutApi:function(){var t=this;this.liveLogout().then((function(e){console.log(e),t.$router.push({name:"Home"})})).catch((function(){console.log("失敗")}))},sendMsg:function(){var t=this;""!=this.userMsg&&this.isAllowSend&&(this.$socket.emit("ChatMessage",{lineId:this.lineData.lineId,name:this.lineData.name,url:this.lineData.profilePicUrl,message:this.userMsg}),this.isAllowSend=!1,this.userMsg="",setTimeout((function(){t.isAllowSend=!0}),1e3))},scrollChatBox:function(){this.chatBoxPst=document.getElementById("chatBox").scrollTop},showNewChat:function(){var t=document.getElementById("chatBox");document.getElementById("chatBox").scrollTo({top:t.scrollHeight,behavior:"smooth"})}}),watch:{}},l=a,r=(s("0a53"),s("2877")),h=Object(r["a"])(l,i,o,!1,null,"36a99786",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-4a31954a.013f907f.js.map